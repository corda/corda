/*
 * R3 Proprietary and Confidential
 *
 * Copyright (c) 2018 R3 Limited.  All rights reserved.
 *
 * The intellectual and technical concepts contained herein are proprietary to R3 and its suppliers and are protected by trade secret law.
 *
 * Distribution of this file or any portion thereof via any medium without the express permission of R3 is strictly prohibited.
 */

description 'Database Migration Tool'

buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath "com.github.jengelman.gradle.plugins:shadow:$shadow_version"
        classpath 'de.sebastianboegl.gradle.plugins:shadow-log4j-transformer:2.1.1'
    }
}

apply plugin: 'application'
apply plugin: 'com.github.johnrengelman.shadow'
apply plugin: 'net.corda.plugins.publish-utils'
apply plugin: 'com.jfrog.artifactory'

mainClassName = 'com.r3.corda.dbmigration.DBMigration'

dependencies {
    compile project(':node')
    // JOpt: for command line flags.
    compile "net.sf.jopt-simple:jopt-simple:$jopt_simple_version"
}

shadowJar {
    transform(de.sebastianboegl.gradle.plugins.shadow.transformers.Log4j2PluginsFileTransformer)
    archiveName = "migration-tool-${version}.jar"
}

task buildMigrationTool(dependsOn: shadowJar)

artifacts {
    publish shadowJar {
        classifier ""
    }
}

jar {
    classifier "ignore"
}

publish {
    name 'tools-database-migration'
    disableDefaultJar = true
}