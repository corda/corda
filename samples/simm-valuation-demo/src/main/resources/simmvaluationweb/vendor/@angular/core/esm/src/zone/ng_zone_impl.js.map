{"version":3,"file":"ng_zone_impl.js","sourceRoot":"","sources":["../../../../../../modules/@angular/core/src/zone/ng_zone_impl.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;AAEH;;;GAGG;AACH;IACE,YAAmB,KAAU,EAAS,UAAe;QAAlC,UAAK,GAAL,KAAK,CAAK;QAAS,eAAU,GAAV,UAAU,CAAK;IAAG,CAAC;AAC3D,CAAC;AAGD;IAcE,YAAY,EAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,YAAY,EAAE,YAAY,EAAE,OAAO,EAOxE;QACC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QACjC,IAAI,CAAC,YAAY,GAAG,YAAY,CAAC;QACjC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QAEvB,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACT,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC;YACvC,EAAE,CAAC,CAAE,IAA8B,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAE,IAA8B,CAAC,aAAa,CAAC,CAAC,CAAC;YAC/E,CAAC;YACD,EAAE,CAAC,CAAC,KAAK,IAAK,IAA8B,CAAC,wBAAwB,CAAC,CAAC,CAAC,CAAC;gBACvE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAE,IAA8B,CAAC,wBAAwB,CAAC,CAAC,CAAC;YAC1F,CAAC;YACD,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;gBAC3B,IAAI,EAAE,SAAS;gBACf,UAAU,EAAO,EAAC,eAAe,EAAE,IAAI,EAAC;gBACxC,YAAY,EAAE,CAAC,QAAsB,EAAE,OAAa,EAAE,MAAY,EAAE,IAAU,EAC/D,SAAc,EAAE,SAAc;oBAC3C,IAAI,CAAC;wBACH,IAAI,CAAC,OAAO,EAAE,CAAC;wBACf,MAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;oBACjE,CAAC;4BAAS,CAAC;wBACT,IAAI,CAAC,OAAO,EAAE,CAAC;oBACjB,CAAC;gBACH,CAAC;gBAGD,QAAQ,EAAE,CAAC,QAAsB,EAAE,OAAa,EAAE,MAAY,EAAE,QAAkB,EACvE,SAAc,EAAE,SAAgB,EAAE,MAAc;oBACzD,IAAI,CAAC;wBACH,IAAI,CAAC,OAAO,EAAE,CAAC;wBACf,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;oBACzE,CAAC;4BAAS,CAAC;wBACT,IAAI,CAAC,OAAO,EAAE,CAAC;oBACjB,CAAC;gBACH,CAAC;gBAED,SAAS,EACL,CAAC,QAAsB,EAAE,OAAa,EAAE,MAAY,EAAE,YAA0B;oBAC9E,QAAQ,CAAC,OAAO,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;oBACvC,EAAE,CAAC,CAAC,OAAO,IAAI,MAAM,CAAC,CAAC,CAAC;wBACtB,yEAAyE;wBACzE,mDAAmD;wBACnD,EAAE,CAAC,CAAC,YAAY,CAAC,MAAM,IAAI,WAAW,CAAC,CAAC,CAAC;4BACvC,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;wBAC5C,CAAC;wBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,YAAY,CAAC,MAAM,IAAI,WAAW,CAAC,CAAC,CAAC;4BAC9C,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,SAAS,CAAC,CAAC;wBAC5C,CAAC;oBACH,CAAC;gBACH,CAAC;gBAEL,aAAa,EAAE,CAAC,QAAsB,EAAE,OAAa,EAAE,MAAY,EAAE,KAAU;oBAE1D,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;oBACpC,IAAI,CAAC,OAAO,CAAC,IAAI,WAAW,CAAC,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;oBAClD,MAAM,CAAC,KAAK,CAAC;gBACf,CAAC;aACrB,CAAC,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;QACxD,CAAC;IACH,CAAC;IAnFD,OAAO,eAAe,KAAc,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC;IAqFxF,QAAQ,CAAC,EAAa,IAAS,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAC3D,eAAe,CAAC,EAAa,IAAS,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IACzE,QAAQ,CAAC,EAAa,IAAS,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;AAC7D,CAAC;AAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * Stores error information; delivered via [NgZone.onError] stream.\n * @deprecated\n */\nexport class NgZoneError {\n  constructor(public error: any, public stackTrace: any) {}\n}\n\n\nexport class NgZoneImpl {\n  static isInAngularZone(): boolean { return Zone.current.get('isAngularZone') === true; }\n\n  /** @internal */\n  private outer: Zone;\n  /** @internal */\n  private inner: Zone;\n\n  private onEnter: () => void;\n  private onLeave: () => void;\n  private setMicrotask: (hasMicrotasks: boolean) => void;\n  private setMacrotask: (hasMacrotasks: boolean) => void;\n  private onError: (error: NgZoneError) => void;\n\n  constructor({trace, onEnter, onLeave, setMicrotask, setMacrotask, onError}: {\n    trace: boolean,\n    onEnter: () => void,\n    onLeave: () => void,\n    setMicrotask: (hasMicrotasks: boolean) => void,\n    setMacrotask: (hasMacrotasks: boolean) => void,\n    onError: (error: NgZoneError) => void\n  }) {\n    this.onEnter = onEnter;\n    this.onLeave = onLeave;\n    this.setMicrotask = setMicrotask;\n    this.setMacrotask = setMacrotask;\n    this.onError = onError;\n\n    if (Zone) {\n      this.outer = this.inner = Zone.current;\n      if ((Zone as any /** TODO #9100 */)['wtfZoneSpec']) {\n        this.inner = this.inner.fork((Zone as any /** TODO #9100 */)['wtfZoneSpec']);\n      }\n      if (trace && (Zone as any /** TODO #9100 */)['longStackTraceZoneSpec']) {\n        this.inner = this.inner.fork((Zone as any /** TODO #9100 */)['longStackTraceZoneSpec']);\n      }\n      this.inner = this.inner.fork({\n        name: 'angular',\n        properties: <any>{'isAngularZone': true},\n        onInvokeTask: (delegate: ZoneDelegate, current: Zone, target: Zone, task: Task,\n                       applyThis: any, applyArgs: any): any => {\n          try {\n            this.onEnter();\n            return delegate.invokeTask(target, task, applyThis, applyArgs);\n          } finally {\n            this.onLeave();\n          }\n        },\n\n\n        onInvoke: (delegate: ZoneDelegate, current: Zone, target: Zone, callback: Function,\n                   applyThis: any, applyArgs: any[], source: string): any => {\n          try {\n            this.onEnter();\n            return delegate.invoke(target, callback, applyThis, applyArgs, source);\n          } finally {\n            this.onLeave();\n          }\n        },\n\n        onHasTask:\n            (delegate: ZoneDelegate, current: Zone, target: Zone, hasTaskState: HasTaskState) => {\n              delegate.hasTask(target, hasTaskState);\n              if (current == target) {\n                // We are only interested in hasTask events which originate from our zone\n                // (A child hasTask event is not interesting to us)\n                if (hasTaskState.change == 'microTask') {\n                  this.setMicrotask(hasTaskState.microTask);\n                } else if (hasTaskState.change == 'macroTask') {\n                  this.setMacrotask(hasTaskState.macroTask);\n                }\n              }\n            },\n\n        onHandleError: (delegate: ZoneDelegate, current: Zone, target: Zone, error: any):\n                           boolean => {\n                             delegate.handleError(target, error);\n                             this.onError(new NgZoneError(error, error.stack));\n                             return false;\n                           }\n      });\n    } else {\n      throw new Error('Angular requires Zone.js polyfill.');\n    }\n  }\n\n  runInner(fn: () => any): any { return this.inner.run(fn); };\n  runInnerGuarded(fn: () => any): any { return this.inner.runGuarded(fn); };\n  runOuter(fn: () => any): any { return this.outer.run(fn); };\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}