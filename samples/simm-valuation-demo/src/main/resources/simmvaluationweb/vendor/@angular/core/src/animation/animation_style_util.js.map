{"version":3,"file":"animation_style_util.js","sourceRoot":"","sources":["../../../../../modules/@angular/core/src/animation/animation_style_util.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ListWrapper, StringMapWrapper} from '../facade/collection';\nimport {isArray, isPresent} from '../facade/lang';\n\nimport {FILL_STYLE_FLAG} from './animation_constants';\nimport {AUTO_STYLE} from './metadata';\n\nexport function prepareFinalAnimationStyles(\n    previousStyles: {[key: string]: string | number}, newStyles: {[key: string]: string | number},\n    nullValue: string = null): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n\n  StringMapWrapper.forEach(newStyles, (value: string, prop: string) => {\n    finalStyles[prop] = value == AUTO_STYLE ? nullValue : value.toString();\n  });\n\n  StringMapWrapper.forEach(previousStyles, (value: string, prop: string) => {\n    if (!isPresent(finalStyles[prop])) {\n      finalStyles[prop] = nullValue;\n    }\n  });\n\n  return finalStyles;\n}\n\nexport function balanceAnimationKeyframes(\n    collectedStyles: {[key: string]: string | number},\n    finalStateStyles: {[key: string]: string | number}, keyframes: any[]): any[] {\n  var limit = keyframes.length - 1;\n  var firstKeyframe = keyframes[0];\n\n  // phase 1: copy all the styles from the first keyframe into the lookup map\n  var flatenedFirstKeyframeStyles = flattenStyles(firstKeyframe.styles.styles);\n\n  var extraFirstKeyframeStyles: {[key: string]: string} = {};\n  var hasExtraFirstStyles = false;\n  StringMapWrapper.forEach(collectedStyles, (value: string, prop: string) => {\n    // if the style is already defined in the first keyframe then\n    // we do not replace it.\n    if (!flatenedFirstKeyframeStyles[prop]) {\n      flatenedFirstKeyframeStyles[prop] = value;\n      extraFirstKeyframeStyles[prop] = value;\n      hasExtraFirstStyles = true;\n    }\n  });\n\n  var keyframeCollectedStyles = StringMapWrapper.merge({}, flatenedFirstKeyframeStyles);\n\n  // phase 2: normalize the final keyframe\n  var finalKeyframe = keyframes[limit];\n  ListWrapper.insert(finalKeyframe.styles.styles, 0, finalStateStyles);\n\n  var flatenedFinalKeyframeStyles = flattenStyles(finalKeyframe.styles.styles);\n  var extraFinalKeyframeStyles: {[key: string]: string} = {};\n  var hasExtraFinalStyles = false;\n  StringMapWrapper.forEach(keyframeCollectedStyles, (value: string, prop: string) => {\n    if (!isPresent(flatenedFinalKeyframeStyles[prop])) {\n      extraFinalKeyframeStyles[prop] = AUTO_STYLE;\n      hasExtraFinalStyles = true;\n    }\n  });\n\n  if (hasExtraFinalStyles) {\n    finalKeyframe.styles.styles.push(extraFinalKeyframeStyles);\n  }\n\n  StringMapWrapper.forEach(flatenedFinalKeyframeStyles, (value: string, prop: string) => {\n    if (!isPresent(flatenedFirstKeyframeStyles[prop])) {\n      extraFirstKeyframeStyles[prop] = AUTO_STYLE;\n      hasExtraFirstStyles = true;\n    }\n  });\n\n  if (hasExtraFirstStyles) {\n    firstKeyframe.styles.styles.push(extraFirstKeyframeStyles);\n  }\n\n  return keyframes;\n}\n\nexport function clearStyles(styles: {[key: string]: string | number}): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n  StringMapWrapper.keys(styles).forEach(key => { finalStyles[key] = null; });\n  return finalStyles;\n}\n\nexport function collectAndResolveStyles(\n    collection: {[key: string]: string | number}, styles: {[key: string]: string | number}[]) {\n  return styles.map(entry => {\n    var stylesObj: {[key: string]: string | number} = {};\n    StringMapWrapper.forEach(entry, (value: string | number, prop: string) => {\n      if (value == FILL_STYLE_FLAG) {\n        value = collection[prop];\n        if (!isPresent(value)) {\n          value = AUTO_STYLE;\n        }\n      }\n      collection[prop] = value;\n      stylesObj[prop] = value;\n    });\n    return stylesObj;\n  });\n}\n\nexport function renderStyles(\n    element: any, renderer: any, styles: {[key: string]: string | number}): void {\n  StringMapWrapper.forEach(\n      styles, (value: string, prop: string) => { renderer.setElementStyle(element, prop, value); });\n}\n\nexport function flattenStyles(styles: {[key: string]: string | number}[]): {[key: string]: string} {\n  var finalStyles: {[key: string]: string} = {};\n  styles.forEach(entry => {\n    StringMapWrapper.forEach(\n        entry, (value: string, prop: string) => { finalStyles[prop] = value; });\n  });\n  return finalStyles;\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}