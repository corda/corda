{"version":3,"file":"ng_form.js","sourceRoot":"","sources":["../../../../../../modules/@angular/common/src/forms-deprecated/directives/ng_form.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Directive, Inject, Optional, Self, forwardRef} from '@angular/core';\n\nimport {EventEmitter, ObservableWrapper, PromiseWrapper} from '../../facade/async';\nimport {ListWrapper} from '../../facade/collection';\nimport {isPresent} from '../../facade/lang';\nimport {AbstractControl, Control, ControlGroup} from '../model';\nimport {NG_ASYNC_VALIDATORS, NG_VALIDATORS} from '../validators';\n\nimport {ControlContainer} from './control_container';\nimport {Form} from './form_interface';\nimport {NgControl} from './ng_control';\nimport {NgControlGroup} from './ng_control_group';\nimport {composeAsyncValidators, composeValidators, setUpControl, setUpControlGroup} from './shared';\n\nexport const formDirectiveProvider: any =\n    /*@ts2dart_const*/ {provide: ControlContainer, useExisting: forwardRef(() => NgForm)};\n\nlet _formWarningDisplayed: boolean = false;\nexport class NgForm extends ControlContainer implements Form {\n  private _submitted: boolean = false;\n\n  form: ControlGroup;\n  ngSubmit = new EventEmitter();\n\n  constructor( validators: any[], asyncValidators: any[]) {\n    super();\n    this._displayWarning();\n    this.form = new ControlGroup(\n        {}, null, composeValidators(validators), composeAsyncValidators(asyncValidators));\n  }\n\n  private _displayWarning() {\n    // TODO(kara): Update this when the new forms module becomes the default\n    if (!_formWarningDisplayed) {\n      _formWarningDisplayed = true;\n      console.warn(`\n      *It looks like you're using the old forms module. This will be opt-in in the next RC, and\n      will eventually be removed in favor of the new forms module. For more information, see:\n      https://docs.google.com/document/u/1/d/1RIezQqE4aEhBRmArIAS1mRIZtWFf6JxN_7B4meyWK0Y/pub\n    `);\n    }\n  }\n\n  get submitted(): boolean { return this._submitted; }\n\n  get formDirective(): Form { return this; }\n\n  get control(): ControlGroup { return this.form; }\n\n  get path(): string[] { return []; }\n\n  get controls(): {[key: string]: AbstractControl} { return this.form.controls; }\n\n  addControl(dir: NgControl): void {\n    PromiseWrapper.scheduleMicrotask(() => {\n      var container = this._findContainer(dir.path);\n      var ctrl = new Control();\n      setUpControl(ctrl, dir);\n      container.registerControl(dir.name, ctrl);\n      ctrl.updateValueAndValidity({emitEvent: false});\n    });\n  }\n\n  getControl(dir: NgControl): Control { return <Control>this.form.find(dir.path); }\n\n  removeControl(dir: NgControl): void {\n    PromiseWrapper.scheduleMicrotask(() => {\n      var container = this._findContainer(dir.path);\n      if (isPresent(container)) {\n        container.removeControl(dir.name);\n      }\n    });\n  }\n\n  addControlGroup(dir: NgControlGroup): void {\n    PromiseWrapper.scheduleMicrotask(() => {\n      var container = this._findContainer(dir.path);\n      var group = new ControlGroup({});\n      setUpControlGroup(group, dir);\n      container.registerControl(dir.name, group);\n      group.updateValueAndValidity({emitEvent: false});\n    });\n  }\n\n  removeControlGroup(dir: NgControlGroup): void {\n    PromiseWrapper.scheduleMicrotask(() => {\n      var container = this._findContainer(dir.path);\n      if (isPresent(container)) {\n        container.removeControl(dir.name);\n      }\n    });\n  }\n\n  getControlGroup(dir: NgControlGroup): ControlGroup {\n    return <ControlGroup>this.form.find(dir.path);\n  }\n\n  updateModel(dir: NgControl, value: any): void {\n    PromiseWrapper.scheduleMicrotask(() => {\n      var ctrl = <Control>this.form.find(dir.path);\n      ctrl.updateValue(value);\n    });\n  }\n\n  onSubmit(): boolean {\n    this._submitted = true;\n    ObservableWrapper.callEmit(this.ngSubmit, null);\n    return false;\n  }\n\n  /** @internal */\n  _findContainer(path: string[]): ControlGroup {\n    path.pop();\n    return ListWrapper.isEmpty(path) ? this.form : <ControlGroup>this.form.find(path);\n  }\n/** @nocollapse */\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: 'form:not([ngNoForm]):not([ngFormModel]),ngForm,[ngForm]',\n  providers: [formDirectiveProvider],\n  host: {\n    '(submit)': 'onSubmit()',\n  },\n  outputs: ['ngSubmit'],\n  exportAs: 'ngForm'\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: {type: Function, decorators?: DecoratorInvocation[]}[] = [\n{type: Array, decorators: [{ type: Optional }, { type: Self }, { type: Inject, args: [NG_VALIDATORS, ] }, ]},\n{type: Array, decorators: [{ type: Optional }, { type: Self }, { type: Inject, args: [NG_ASYNC_VALIDATORS, ] }, ]},\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}